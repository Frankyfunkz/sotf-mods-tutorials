<!DOCTYPE html>
<html>
    <head>
        <title>Finding what we want to do</title>
        <link rel="stylesheet" href="../../right-frame-template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark-dimmed.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
    </head>
    <body>
        <h1>Finding what we want to do</h1>

        <h2>Looking into dnSpy for something to change</h2>
        <p>
            As we learned in the lesson before, we can look into the game code using tools like <b>dnSpy</b>.
            <br>So now we can develop another mod looking into it.
            <br>This time we are gonna change the player health, stamina etc.
        </p>

        <p>
            So, open up dnSpy and if not already load all the source code dll's as we did in the lesson before.
            <br>After that, search for the <q><b>LocalPlayer</b></q> like the last time and, unlike before, instead of selecting
             the <b>FirstPersonCharacter</b>, we will select the <q><b>Vitals</b></q> entry.

            <img style="display: block;" src="images/Vitals-entry.png" width="800px">           
        </p>

        <p>
            As you can see, <b>Vitals</b> contains all the stuff related to the player health, stamina, rest, fullness etc.
            <br>This means that if we get a reference of it, we can change all of this stuff.  

            <img style="display: block;" src="images/Vitals-dropdown.png" width="350px">        
        </p>

        <p>
            If you scroll down a bit, you will see methods like <b>SetHealth</b> or <b>SetStamina</b>.
            
            <img style="display: block;" src="images/Vitals-methods.png" width="400px">    
        </p>

        <p>
            Those are the ones we will use to make the next mod.
            <br>But before creating the mod project and start making the mod, let test the changes in game with <b>UnityExplorer</b> first,
            so we can be sure it's what we want to do and that it will work.
        </p>

        <h2>Testing what we want to change using UnityExplorer</h2>
        <p>
            So you can now boot the game, load into a savegame and open up UnityExplorer pressing F7.
            <br>Now go into the <b>Object Search</b> tab as we did with the first mod and in the <b>Class filter</b>
            type <b>LocalPlayer</b> &#40;we could also type <b>Vitals</b> directly but let not do it for now&#41;.
            <br>Hit search and select one of the results &#40;they are the same&#41;.
            <br>Now, with the LocalPlayer window opened, scroll down or search for <q><b>Vitals</b></q>.
            <br>Click on <b>Inspect</b> and you will get all the Vitals related stuff.
            <br>If you scroll down, you will find ours <b>SetHealth</b> and <b>SetStamina</b> methods we saw in dnSpy before.
        </p>

        <p>
            Now, as in the first mod remake in UnityExplorer, click on evaluate on each method and type the appropriate values
            &#40;e.g 50 for <b>SetHealth</b> and 10 for <b>SetStamina</b>&#41;.
            <br> Now click evaluate on each of them to execute eachself and you will see the player health went to 50 and stamina to 10.

            <img style="display: block;" src="images/UE-Vitals-methods.png" width="500px">    
        </p>

        <p>
            Now that we have confirmed these are the methods we need and that they work fine, we can start making the mod project.
        </p>

        <div class="bottom-buttons">
            <a href="../dnSpy-usage/dnSpy-usage.html" target="pointed-iframe"><button>Previous lesson</button></a>
            <a href="../Making-the-mod/making-the-mod.html" target="pointed-iframe"><button>Next lesson</button></a>
        </div>

    </body>
</html>